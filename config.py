import os
from typing import Dict
from urllib.parse import urlparse

from dotenv import load_dotenv

# Load environment variables from .env if present
load_dotenv()

# Telegram Bot
BOT_TOKEN = os.getenv('BOT_TOKEN')
BOT_USERNAME = os.getenv('BOT_USERNAME')

# Marzban API
MARZBAN_BASE_URL = os.getenv('MARZBAN_BASE_URL')
MARZBAN_USERNAME = os.getenv('MARZBAN_USERNAME')
MARZBAN_PASSWORD = os.getenv('MARZBAN_PASSWORD')

# YooMoney
YOOMONEY_WALLET_ID = os.getenv('YOOMONEY_WALLET_ID')
YOOMONEY_NOTIFICATION_SECRET = os.getenv('YOOMONEY_NOTIFICATION_SECRET')

# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (Teletype) –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
INSTRUCTION_URL = os.getenv('INSTRUCTION_URL')

# –ü–æ–¥–¥–µ—Ä–∂–∫–∞ (URL —á–∞—Ç–∞/–Ω–∏–∫)
SUPPORT_URL = os.getenv('SUPPORT_URL')
 
# –ù–æ–≤–æ—Å—Ç–Ω–æ–π –∫–∞–Ω–∞–ª (URL)
NEWS_URL = os.getenv('NEWS_URL')
_news_username_env = os.getenv('NEWS_CHANNEL_USERNAME', '').strip()
NEWS_CHANNEL_USERNAME = _news_username_env.lstrip('@').lower() if _news_username_env else None
if not NEWS_CHANNEL_USERNAME and NEWS_URL:
    try:
        parsed = urlparse(NEWS_URL)
        candidate = (parsed.path or '').strip('/')
        if candidate:
            candidate = candidate.split('/')[-1]
        if candidate:
            NEWS_CHANNEL_USERNAME = candidate.lstrip('@').lower()
    except Exception:
        NEWS_CHANNEL_USERNAME = None

_news_channel_id_raw = os.getenv('NEWS_CHANNEL_ID', '').strip()
NEWS_CHANNEL_ID: int | None = None
if _news_channel_id_raw:
    try:
        NEWS_CHANNEL_ID = int(_news_channel_id_raw)
    except ValueError:
        NEWS_CHANNEL_ID = None

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ
USER_AGREEMENT_URL = os.getenv('USER_AGREEMENT_URL')

# –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
ADMIN_IDS = []
ADMIN_IDS_STR = []
_raw_admins = os.getenv('ADMIN_IDS', '').strip()
if _raw_admins:
    try:
        parts = [x for x in _raw_admins.replace(' ', '').split(',') if x]
        ADMIN_IDS_STR = parts
        ADMIN_IDS = [int(x) for x in parts if x.isdigit()]
    except Exception:
        ADMIN_IDS = []
        ADMINIDS_STR = []
_single_admin = os.getenv('ADMIN_ID', '').strip()
if _single_admin:
    try:
        if _single_admin.isdigit():
            aid = int(_single_admin)
            if aid not in ADMIN_IDS:
                ADMIN_IDS.append(aid)
        if _single_admin not in ADMIN_IDS_STR:
            ADMIN_IDS_STR.append(_single_admin)
    except Exception:
        pass

# –†–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è ‚Äî —Ñ–∞–π–ª-—Ñ–ª–∞–≥ (–º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —á–µ—Ä–µ–∑ env)
MAINTENANCE_FLAG_FILE = os.getenv('MAINTENANCE_FLAG_FILE', 'maintenance.lock')

# Webhook server (FastAPI)
# Provide safe defaults to avoid crashes when env vars are missing in dev
WEBHOOK_HOST = os.getenv('WEBHOOK_HOST', '0.0.0.0')
try:
    WEBHOOK_PORT = int(os.getenv('WEBHOOK_PORT', '8080'))
except ValueError:
    WEBHOOK_PORT = 8080

# –ü–æ–¥–ø–∏—Å–∫–∏ –∏ —Ü–µ–Ω—ã
SUBSCRIPTION_PLANS: Dict[str, Dict] = {
    "1_month": {
        "name": "1 –º–µ—Å—è—Ü",
        "days": 30,
        "price": 249,
    },
    "3_months": {
        "name": "3 –º–µ—Å—è—Ü–∞",
        "days": 90,
        "price": 649,
        
    },
    "6_months": {
        "name": "6 –º–µ—Å—è—Ü–µ–≤",
        "days": 180,
        "price": 1099,
        
    }
}

# –¢–µ–∫—Å—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π (HTML)
MESSAGES = {
    "welcome": (
        "üåê <b>AVERRA VPN</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "‚ú® <b>–°–≤–æ–±–æ–¥–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤ –æ–¥–∏–Ω –∫–ª–∏–∫</b>\n"
        "<i>–ü–æ–¥–∫–ª—é—á–∞–π—Ç–µ—Å—å –∑–∞ —Å–µ–∫—É–Ω–¥—ã –∏ –ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º –±–µ–∑ –≥—Ä–∞–Ω–∏—Ü.</i>\n\n"
        "üõ°Ô∏è –®–∏—Ñ—Ä—É–µ–º –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫\n"
        "üöÄ –î–µ—Ä–∂–∏–º —Å—Ç–∞–±–∏–ª—å–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å\n"
        "üì± –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ª—é–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö\n"
        "üõü –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 24/7 –≤—Å–µ–≥–¥–∞ —Ä—è–¥–æ–º\n\n"
        "üëá –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π —Ä–∞–∑–¥–µ–ª –∏ –Ω–∞—á–Ω–∏—Ç–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!"
    ),

    "no_subscription": (
        "üì¶ <b>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ–Ω—ã–π –ø–ª–∞–Ω</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "üåç <b>–°—Ç—Ä–∞–Ω—ã –≤ –ø–æ–¥–ø–∏—Å–∫–µ</b>:\n{countries}\n\n‚Äº–û–±—Ö–æ–¥ –≥–ª—É—à–∏–ª–æ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –¢2, –ú–¢–°, –†–æ—Å—Ç–µ–ª–µ–∫–æ–º"
    ),

    "payment_info": (
        "üí≥ <b>–û–ø–ª–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∫–∏</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "üì¶ –¢–∞—Ä–∏—Ñ: <b>{plan_name}</b>\n"
        "üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: <b>{price} ‚ÇΩ</b>\n"
        "üìÖ –°—Ä–æ–∫: <b>{days} –¥–Ω–µ–π</b>\n\n"
        "–û–ø–ª–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ –¥–ª—è –æ–ø–ª–∞—Ç—ã:"
    ),

    # –ü–æ–¥–ø–∏—Å–∫–∞ ‚Äî –µ–¥–∏–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è
    "subscription_active": (
        "üìä <b>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–ø–∏—Å–∫–µ</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: <b>{display_username}</b>\n"
        "‚è≥ –ò—Å—Ç–µ–∫–∞–µ—Ç: <b>{expire_date}</b>\n"
        "üìà –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: <b>{used_gb} –ì–ë</b> / <b>{total_gb}</b>\n\n"
        "üîó <b>–°—Å—ã–ª–∫–∞ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</b>\n<code>{subscription_url}</code>\n\n"
        "‚ö†Ô∏è –ü–µ—Ä–µ–¥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –æ—Ç–∫—Ä–æ–π—Ç–µ –∫–Ω–æ–ø–∫—É \"–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è\" –Ω–∏–∂–µ –∏ —Å–ª–µ–¥—É–π—Ç–µ —à–∞–≥–∞–º."
    ),
    "subscription_expired": (
        "‚õî <b>–ü–æ–¥–ø–∏—Å–∫–∞ –∏—Å—Ç–µ–∫–ª–∞</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "–î–æ—Å—Ç—É–ø –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ö—É–ø–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–µ—Ä–≤–∏—Å–æ–º.\n\n"
        "–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É \"–ö—É–ø–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É\" –Ω–∏–∂–µ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Ç–∞—Ä–∏—Ñ."
    ),

    # –ö–Ω–æ–ø–∫–∏ —Ç–∞—Ä–∏—Ñ–æ–≤
    "plan_button": "{name} - {price} ‚ÇΩ",

    # –û—à–∏–±–∫–∏/–∞–ª–µ—Ä—Ç—ã
    "invalid_plan_alert": "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ç–∞—Ä–∏—Ñ",

    # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ–ø–ª–∞—Ç–µ
    "payment_activated_title": "üéâ <b>–ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞!</b>",
    "payment_received": (
        "‚úÖ <b>–û–ø–ª–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∞</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "{status_line}\n"
        "‚è≥ –î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ: <b>{expire_str}</b>\n\n"
        "–û—Ç–∫—Ä–æ–π—Ç–µ –∫–Ω–æ–ø–∫—É \"–ú–æ—è –ø–æ–¥–ø–∏—Å–∫–∞\" –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç—É—Å –∏ –ø–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫—É."
    ),

    "subscription_expiring": (
        "‚è≥ <b>–ü–æ–¥–ø–∏—Å–∫–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "–í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –∏—Å—Ç–µ–∫–∞–µ—Ç –∑–∞–≤—Ç—Ä–∞: <b>{expire_str}</b>.\n\n"
        "–ü—Ä–æ–¥–ª–∏—Ç–µ –∑–∞—Ä–∞–Ω–µ–µ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ—Ä—ã–≤–æ–≤ –≤ –¥–æ—Å—Ç—É–ø–µ."
    ),

    # –ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥
    "trial_activated_title": "üéÅ <b>–ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!</b>",
    "trial_activated": (
        "‚úÖ <b>–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –ø—Ä–æ–±–Ω—ã–π –¥–æ—Å—Ç—É–ø</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "{status_line}\n"
        "‚è≥ –î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ: <b>{expire_str}</b>\n\n"
        "–û—Ç–∫—Ä–æ–π—Ç–µ –∫–Ω–æ–ø–∫—É \"–ú–æ—è –ø–æ–¥–ø–∏—Å–∫–∞\" –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫—É –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏."
    ),
}


# –¢–µ–∫—Å—Ç—ã –∫–Ω–æ–ø–æ–∫ (UI)
BUTTONS = {
    "my_subscription": "üìä –ú–æ—è –ø–æ–¥–ø–∏—Å–∫–∞",
    "buy_subscription": "üí≥ –ö—É–ø–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É",
    "extend_subscription": "üîÑ –ü—Ä–æ–¥–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É",
    "instruction": "üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è",
    "back": "üîô –ù–∞–∑–∞–¥",
    "pay": "üí≥ –û–ø–ª–∞—Ç–∏—Ç—å",
    "back_to_plans": "üîô –ù–∞–∑–∞–¥ –∫ —Ç–∞—Ä–∏—Ñ–∞–º",
    "support": "üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞",
    "news": "üì∞ –ù–æ–≤–æ—Å—Ç–Ω–æ–π –∫–∞–Ω–∞–ª",
    "referrals": "üë• –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞",
    "share_referral": "üì® –°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –¥—Ä—É–≥–∞",
    "sync_usernames": "üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–æ–≤–∞—Ç—å —é–∑–µ—Ä–Ω–µ–π–º—ã",
    "admin_panel": "üõ†Ô∏è –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å",
    "maintenance_enable": "üü• –í–∫–ª—é—á–∏—Ç—å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ",
    "maintenance_disable": "üü© –í—ã–∫–ª—é—á–∏—Ç—å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ",
    "backup": "üóÑÔ∏è –ë—ç–∫–∞–ø Marzban",
    "create_promo": "üéüÔ∏è –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥",
    "enter_promo": "üéüÔ∏è –í–≤–µ—Å—Ç–∏ –ø—Ä–æ–º–æ–∫–æ–¥",
    "broadcast": "üì£ –†–∞—Å—Å—ã–ª–∫–∞",
    "broadcast_all": "üì° –í—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º",
    "broadcast_one": "üéØ –û–¥–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é",
    "user_agreement": "üìÑ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ",
}

# –†–µ—Ñ–µ—Ä–∞–ª—ã
REFERRAL = {
    "param": "ref",  # –∏–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ deep-link
    "note_prefix": "ref:",  # –ø—Ä–µ—Ñ–∏–∫—Å –∑–∞–º–µ—Ç–∫–∏ (note) –≤ –ø—Ä–æ—Ñ–∏–ª–µ
    "bonus_percent": 30,
}

# –°–æ–æ–±—â–µ–Ω–∏—è –æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–º –±–æ–Ω—É—Å–µ
MESSAGES.update({
    "ref_bonus_title": "üéÅ <b>–ù–∞—á–∏—Å–ª–µ–Ω —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –±–æ–Ω—É—Å</b>",
    "ref_bonus_body": (
        "–í–∞–º –Ω–∞—á–∏—Å–ª–µ–Ω–æ <b>{bonus_days} –¥.</b> –∑–∞ –æ–ø–ª–∞—Ç—É –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.\n"
        "–¢–µ–∫—É—â–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ –ø—Ä–æ–¥–ª–µ–Ω–∞ –¥–æ: <b>{expire_str}</b>."
    ),
})

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ
MESSAGES.update({
    "ref_info": (
        "üë• <b>–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "üîó <b>–í–∞—à–∞ —Å—Å—ã–ª–∫–∞</b>\n<code>{ref_link}</code>\n\n"
        "üìä <b>–í–∞—à–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—ã</b>: <b>{ref_count}</b>\n\n"
        "üí° –ó–∞ –∫–∞–∂–¥—É—é –æ–ø–ª–∞—Ç—É –ø–æ –≤–∞—à–µ–π —Å—Å—ã–ª–∫–µ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ <b>{percent}%</b> –¥–Ω–µ–π –æ—Ç –∫—É–ø–ª–µ–Ω–Ω–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞.\n\n"
        "–ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π –∏ –ø—Ä–æ–¥–ª–µ–≤–∞–π—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É –≤—ã–≥–æ–¥–Ω–æ!"
    )
})

MESSAGES.update({
    "ref_share_text": (
        "–ü—Ä–∏–≤–µ—Ç! –Ø –ø–æ–ª—å–∑—É—é—Å—å AVERRA VPN ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∏ –±—ã—Å—Ç—Ä—ã–π —Å–µ—Ä–≤–∏—Å.\n"
        "–ü–µ—Ä–µ–π–¥–∏ –ø–æ –º–æ–µ–π —Å—Å—ã–ª–∫–µ –∏ –ø–æ–¥–∫–ª—é—á–∞–π—Å—è: {ref_link}\n"
    ),
})

# –†–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
MESSAGES.update({
    "maintenance_active": (
        "üöß –†–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "–ë–æ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–π–¥–∏—Ç–µ –ø–æ–∑–∂–µ."
    ),
    "admin_panel": (
        "üõ†Ô∏è <b>–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:"
    ),
    "maintenance_enabled": "‚úÖ –†–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –≤–∫–ª—é—á—ë–Ω",
    "maintenance_disabled": "‚úÖ –†–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –≤—ã–∫–ª—é—á–µ–Ω",
    "backup_started": "‚è≥ –ó–∞–ø—É—Å–∫–∞—é –±—ç–∫–∞–ø...",
    "backup_success": "‚úÖ –ë—ç–∫–∞–ø —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω",
    "backup_failed": "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –±—ç–∫–∞–ø–∞",
    "broadcast_menu": (
        "üì£ <b>–†–∞—Å—Å—ã–ª–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ä–∞—Å—Å—ã–ª–∫–∏ –∏ –¥–∞–ª–µ–µ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç.\n"
        "–í–æ –≤—Ä–µ–º—è –≤–≤–æ–¥–∞ –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å <b>–û—Ç–º–µ–Ω–∞</b>, —á—Ç–æ–±—ã –≤—ã–π—Ç–∏."
    ),
    "broadcast_all_prompt": (
        "üì° <b>–†–∞—Å—Å—ã–ª–∫–∞ –≤—Å–µ–º</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ –¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.\n"
        "–ú–æ–∂–Ω–æ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ç–µ–∫—Å—Ç –∏–ª–∏ –º–µ–¥–∏–∞. –î–ª—è –æ—Ç–º–µ–Ω—ã –æ—Ç–ø—Ä–∞–≤—å—Ç–µ <b>–û—Ç–º–µ–Ω–∞</b>."
    ),
    "broadcast_user_prompt": (
        "üéØ <b>–†–∞—Å—Å—ã–ª–∫–∞ –æ–¥–Ω–æ–º—É</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "–í–≤–µ–¥–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—á–∏—Å–ª–æ). –î–ª—è –æ—Ç–º–µ–Ω—ã –æ—Ç–ø—Ä–∞–≤—å—Ç–µ <b>–û—Ç–º–µ–Ω–∞</b>."
    ),
    "broadcast_enter_message": (
        "‚úçÔ∏è –í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.\n"
        "–î–ª—è –æ—Ç–º–µ–Ω—ã –æ—Ç–ø—Ä–∞–≤—å—Ç–µ <b>–û—Ç–º–µ–Ω–∞</b>."
    ),
    "broadcast_started": "üöÄ –ó–∞–ø—É—Å–∫–∞—é —Ä–∞—Å—Å—ã–ª–∫—É...",
    "broadcast_done_all": "‚úÖ –†–∞—Å—Å—ã–ª–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: <b>{sent}</b> –∏–∑ <b>{total}</b>.",
    "broadcast_done_one": "‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é <code>{user_id}</code>.",
    "broadcast_failed_one": "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é <code>{user_id}</code>.",
    "broadcast_cancelled": "‚ùé –†–∞—Å—Å—ã–ª–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞.",
    "broadcast_invalid_user": "‚ùå ID –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –û—Ç–º–µ–Ω–∞.",
    "broadcast_no_recipients": "‚ö†Ô∏è –ü–æ–ª—É—á–∞—Ç–µ–ª–µ–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.",
})

MESSAGES.update({
    "sync_usernames_started": "üîÑ –ù–∞—á–∏–Ω–∞—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —é–∑–µ—Ä–Ω–µ–π–º–æ–≤...",
    "sync_usernames_done": (
        "‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞\n"
        "–í—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: <b>{total}</b>\n"
        "–û–±–Ω–æ–≤–ª–µ–Ω–æ: <b>{updated}</b>\n"
        "–ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: <b>{unchanged}</b>\n"
        "–ù–µ—Ç username: <b>{missing}</b>\n"
        "–û—à–∏–±–æ–∫: <b>{errors}</b>"
    ),
    "sync_usernames_error": "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é.",
    "sync_usernames_no_users": "‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.",
})

# –ü—Ä–æ–º–æ–∫–æ–¥—ã
PROMO_CODES_FILE = os.getenv('PROMO_CODES_FILE', 'promocodes.json')
MESSAGES.update({
    "promo_create_prompt": (
        "üéüÔ∏è <b>–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ:"
    ),
    "promo_created": (
        "‚úÖ <b>–ü—Ä–æ–º–æ–∫–æ–¥ —Å–æ–∑–¥–∞–Ω</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "–¢–∞—Ä–∏—Ñ: <b>{plan_name}</b>\n"
        "–ö–æ–¥: <code>{code}</code>"
    ),
    "promo_prompt": "üéüÔ∏è –í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥ –æ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º",
    "promo_invalid": "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥",
    "promo_used": "‚ö†Ô∏è –≠—Ç–æ—Ç –ø—Ä–æ–º–æ–∫–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω",
    "promo_applied": (
        "üéâ <b>–ü—Ä–æ–º–æ–∫–æ–¥ –ø—Ä–∏–º–µ–Ω—ë–Ω!</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        "–¢–∞—Ä–∏—Ñ: <b>{plan_name}</b>\n"
        "–ü–æ–¥–ø–∏—Å–∫–∞ –¥–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ: <b>{expire_str}</b>"
    ),
})


